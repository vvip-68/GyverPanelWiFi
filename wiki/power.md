## Заметки о питании

Рабочее напряжение микроконтроллера (логические уровни) - 3.3 вольта.  
Рабочее напряжение матрицы - 4.0 - 5.5 вольт.  
При питающем напряжении с источника питания 4.0-4.8 вольт включение диода не обязательно, т.к уровни логических сигналов на пинах мкроконтроллера и DIN ленты согласуются достаточно хорошо.  
Если же напряжение с блока питания составляет 5.0-5.6 вольта - без включения диода матрица надежно работать не будет из за несогласованности уровней логики.  
Включение кремниевого диода по такой схеме позволяет поднять уровень массы микроконтроллера относительно массы матрицы на 0.6-0.8 вольта в зависимости от диода, 
что в результате повышает уровень логической 1 на выходных пинах микроконтроллера до 3.3+0.6 ~= 3.8-3.9 вольта относительно "земли" матрицы, которые матрица уверенно распознает даже при повышении
напряжения с блока питания до 5.5-6 вольт. Диод можно взять, например, 1N4007 (или другой кремниевый с током не менее 0.5A)  

Корректировка напряжения с блока питания до 5-6 В также обязательна, если вы используете управление питанием матрицы через MOSFET, поскольку большинство распространенных мосфетов
логического уровня надежно открываются лишь при напряжении на затворе не ниже 5 вольт. Схемы управления питанием для P-канального MOSFET IRF4905 и N-канального MOSFET IRF3205 приведены ниже.  

```
# Рекомендация по питанию

Наиболее стабильная работа устройства обеспечивается при питании схемы напряжением 4.6-4.9 вольт (не выше!).
При этом корректирующий диод в зазрыв GND питания микроконтроллера ставить не нужно.
Для схем, использующих DFPlayer, питание на него (VCC) в этом случае подавать с общего плюса питания, 
а не с пина 3.3 вольта микроконтроллера, поскольку пин 3.3 вольта не обеспечивает достаточного 
для потребления DFPlayer'ом тока, что приведет к недостаточной громкости воспроизведения, а в худшем 
случае - выходу из строя микросхемы стабилизатора напряжения 3.3 вольта микроконтроллера.
```

## Управление питанием

Матрица, даже если она "выключена" и ничего не отображает все равно потребляет довольно значительный ток от источника питания.
Микросхемы светодиодов продолжают работать, ожидают поступление сигнала. Для проектов, работающих от аккумуляторов это может
представлять проблему - аккумулятор быстро садится.  

Для исправления этой ситуации с микроконтроллера на управляющий пин выведен сигнал включения / отключения питания матрицы.
Управление питанием реализуется следующими схемами:

P-канальный MOSFET IRF4905 обеспечивает ток питания матрицы 74А при 25 градусах, 52А - при 100 градусах.

![SCHEME](https://github.com/vvip-68/GyverPanelWiFi/blob/master/schemes/mosfet.jpg)

N-канальный MOSFET IRF3205 обеспечивает ток питания матрицы 30А при 25 градусах, 40А - при 100 градусах.

![SCHEME](https://github.com/vvip-68/GyverPanelWiFi/blob/master/schemes/mosfet2.jpg)

Оптрон PC817 - гальваническая развязка и защита пина ESP, а также обеспечивает управление уровнем 3.3 вольта
с которым работает микроконтроллер. Мосфет лучше брать в корпусе TO-220. 
Для обеспечения большого тока питания матрицы MOSFET'ы обязательно устанавливать на радиаторы!
Управляющий сигнал POWER_ON в HIGH для включения питания матрицы, POWER_OFF в LOW для отключения питания матрицы.
